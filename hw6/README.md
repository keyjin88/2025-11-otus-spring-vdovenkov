# Домашнее задание

Переписать приложение для хранения книг на ORM

***Цель:***

Цель: Перевести приложение каталог книг в библиотеке на репозитории, использующие в качестве технологии доступа к данным, Spring ORM, JPA и Hibernate. Дополнить доменную модель сущностью комментария к книге. Задание выполняется на базе предыдущей работы, но также имеет заготовку содержащую тесты, проверяющие некоторые из требований к заданию. Решение должно удовлетворять нижеуказанным требованиям.
Результат: Высокоуровневое приложение с JPA-маппингом сущностей

***Описание/Пошаговая инструкция выполнения домашнего задания:***

Домашнее задание выполняется переписыванием предыдущего на JPA.
Требования:

1. Использовать Spring ORM, JPA и Hibernate (EntityManager) в качестве технологии доступа к данным
2. Spring Data пока использовать нельзя
3. Добавить сущность "комментария к книге" (много комментариев к одной книге)
4. Реализовать CRUD операции для новой сущности. Получение всех комментариев делать не нужно. Только конкретного комментария по id и всех комментариев по конкретной книге по ее id
5. Загрузка связей сущностей не должна приводить к большому количеству запросов к БД или избыточному по объему набору данных (проблема N+1 и проблема произведения таблиц)
6. DDL через Hibernate должно быть отключено
7. LAZY-связи не должны присутствовать в equals/hashCode/toString. В т.ч. за счет @Data
8. Проблема N+1 должна быть решена теми же способами, что и в прошлой работе, но уже через инструменты, предоставляемыми ORM
9. Аннотация @Transactional должна присутствовать только на методах сервиса
10. Покрыть все репозитории тестами, используя H2 базу данных и @DataJpaTest
11. В тестах репозиториев, для проверки или подготовки данных использовать TestEntityManager (только методы не требующие написания запросов). Сами репозитории для этого использовать нельзя
12. Написать интеграционные тесты сервисов книг и комментариев, где проверить, что доступ к связям, которые используются снаружи серивсов не вызывают LazyInitialzationException
13. Не забыть учесть в тестах, что тестовый контекст кэшируется, т.е. должны проходить как все тесты разом, так и по отдельности
14. Для приема работы тесты из заготовки должны проходить
15. Без фанатизма)

Это домашнее задание будет использоваться в качестве основы для других ДЗ
Данная работа не засчитывает предыдущую!
